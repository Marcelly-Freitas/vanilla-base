import{t as i}from"./turmaEntityService.service-C-A0ySkN.js";import{a as m}from"./index-Ckh9VWKK.js";import"./useLocalstorage-BtQVKKxs.js";function d(){const r=window.location.href,t=/\/turmas\/editar\/([a-zA-Z0-9-]+)/,e=r.match(t);return e?e[1]:null}function u(r,t=!0){if(r){const e=r.querySelectorAll("input, select"),a=r.querySelector("button[type=submit]");t?(e.forEach(o=>{o.setAttribute("disabled","disabled")}),a.setAttribute("disabled","disabled"),a.textContent="Carregando..."):(e.forEach(o=>{o.removeAttribute("disabled")}),a.removeAttribute("disabled"),a.textContent="Salvar")}}async function f(r){const t=document.querySelector("#turma-form");u(t,!0);try{const{data:e}=await i.getByCode(r);e&&(console.log({turma:e}),t.querySelector("#nome").value=e.nome||"",t.querySelector("#professor").value=e.professor||"",t.querySelector("#inicio").value=e.inicio||"",t.querySelector("#encerramento").value=e.encerramento||"",t.querySelector("#max_alunos").value=e.max_alunos||"",t.querySelector("#horario").value=e.horario||"",t.querySelector("#semestre").value=e.semestre||"",(e.dias_semana?e.dias_semana.split(","):[]).forEach(o=>{const c=t.querySelector(`input[type=checkbox][value=${o}]`);c&&(c.checked=!0)}))}catch(e){console.error("Erro ao carregar dados da turma:",e)}u(t,!1)}async function y(r){r.preventDefault();const t=document.querySelector("#turma-form"),e=t.querySelectorAll("input, select"),{showNotification:a}=m();if(u(t),e){const o={};e.forEach(s=>{const n=s.getAttribute("name"),l=s.type==="checkbox"?s.checked&&s.value:s.value;l&&(o[n]?o[n]+=`,${l}`:o[n]=l)});const c=d();try{await i.update(c,o),a({type:"success",title:"Sucesso",message:"Dados alterados com sucesso"}),navigateToRoute(null,"/turmas/visualizar")}catch(s){console.error("Erro ao atualizar dados da turma:",s),a({type:"error",title:"Erro",message:"Erro ao atualizar os dados da turma"})}finally{u(t,!1)}}}const v={init(){window.onFormSubmit=y;const r=d();r&&f(r)}};export{v as default};
